<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Apple Music Downloader</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body class="bg-dark text-light">

<div class="container-fluid p-3">
    <!-- Top bar -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <button class="btn btn-outline-light">
                âš™ Settings
            </button>
        </div>
        <div>
            <span id="wrapper-indicator" class="badge {{ 'bg-success' if wrapper_running else 'bg-danger' }}">
                Wrapper: {{ 'Running' if wrapper_running else 'Stopped' }}
            </span>
        </div>
    </div>

    <!-- Middle input area -->
    <div class="text-center mb-4">
        <input id="link-box" type="text" class="form-control form-control-lg mb-3 w-50 mx-auto" placeholder="Paste Apple Music link here">
        
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="format" id="atmos" value="ATMOS" checked>
            <label class="form-check-label" for="atmos">ATMOS</label>
        </div>
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="format" id="aac" value="AAC">
            <label class="form-check-label" for="aac">AAC</label>
        </div>

        <div class="mt-3">
            <button id="download-btn" class="btn btn-primary btn-lg">Download</button>
        </div>
    </div>

    <!-- Bottom logs -->
    <div class="row">
        <div class="col-md-6">
            <h5>Downloader Logs</h5>
            <div class="log-box" id="downloader-logs"></div>
        </div>
        <div class="col-md-6">
            <h5>Wrapper Logs</h5>
            <div class="log-box" id="wrapper-logs"></div>
        </div>
    </div>
</div>

<script>
document.getElementById("download-btn").addEventListener("click", () => {
    const link = document.getElementById("link-box").value;
    const format = document.querySelector("input[name='format']:checked").value;

    axios.post("/download", { link: link, format: format })
        .then(res => {
            const logs = document.getElementById("downloader-logs");
            logs.innerHTML += `<div>> ${res.data.msg}</div>`;
            logs.scrollTop = logs.scrollHeight;
        });
});
</script>
</body>
</html>
